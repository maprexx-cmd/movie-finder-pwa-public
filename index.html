<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Movie Finder</title>

<style>
body{
margin:0;
font-family:system-ui;
background:linear-gradient(180deg,#050813,#0b1020);
color:#e5e7eb;
padding:16px;
}
.card{
background:rgba(255,255,255,.04);
border-radius:22px;
padding:18px;
margin-bottom:16px;
border:1px solid rgba(255,255,255,.12);
}
h1,h2,h3{margin:0 0 10px}
.small{font-size:13px;color:#9ca3af}
.btn{
padding:14px 20px;
border-radius:999px;
border:none;
font-weight:900;
cursor:pointer;
}
.main{
background:linear-gradient(90deg,#d9ff2f,#39ff6b);
color:#1e40af;
}
.secondary{
background:transparent;
border:1px solid rgba(255,255,255,.2);
color:#fff;
}
.hidden{display:none}
.row{display:flex;gap:10px;flex-wrap:wrap}
.genre{margin-bottom:12px}
input[type=checkbox]{width:20px;height:20px}
input[type=range]{width:100%}
.result{
border:1px solid rgba(255,255,255,.12);
border-radius:18px;
padding:10px;
display:grid;
grid-template-columns:90px 1fr;
gap:12px;
margin-bottom:12px;
}
.poster{
width:90px;height:135px;
background:#000;
border-radius:14px;
overflow:hidden;
}
.poster img{width:100%;height:100%;object-fit:cover}
.fade{
position:fixed;
inset:0;
background:#000;
display:none;
align-items:center;
justify-content:center;
flex-direction:column;
z-index:10;
}
.fade.show{display:flex}
</style>
</head>

<body>

<div class="card" id="home">
<h1>Movie Finder</h1>
<p class="small">COSA VUOI GUARDARE OGGI?</p>
<div class="row">
<button class="btn main" onclick="openBasic()">Versione BASIC</button>
<button class="btn secondary" onclick="openPremium()">Versione PREMIUM</button>
</div>
</div>

<div class="card hidden" id="basic">
<h2>BASIC, gratuita</h2>
<p class="small">3 film, 1 ricerca al giorno</p>

<div class="genre">
<label><input type="checkbox" value="35"> Comico</label>
</div>
<div class="genre">
<label><input type="checkbox" value="28"> Azione</label>
</div>
<div class="genre">
<label><input type="checkbox" value="10749"> Romantico</label>
</div>
<div class="genre">
<label><input type="checkbox" value="16"> Cartoni animati</label>
</div>

<button class="btn main" onclick="searchBasic()">Trova film</button>
</div>

<div class="card hidden" id="premium">
<h2>PREMIUM</h2>
<p class="small">Slider 0â€“5, risultati illimitati</p>

<h3>Tipo</h3>
<div class="row">
<button class="btn secondary" onclick="setType('movie')">Film</button>
<button class="btn secondary" onclick="setType('tv')">Serie TV</button>
</div>

<h3>Preferenze</h3>

<div class="genre">Comico
<input type="range" min="0" max="5" value="0" data-genre="35">
</div>
<div class="genre">Azione
<input type="range" min="0" max="5" value="0" data-genre="28">
</div>
<div class="genre">Romantico
<input type="range" min="0" max="5" value="0" data-genre="10749">
</div>
<div class="genre">Animazione
<input type="range" min="0" max="5" value="0" data-genre="16">
</div>

<button class="btn main" onclick="searchPremium()">Procedi</button>
</div>

<div class="card hidden" id="results">
<h2>Risultati</h2>
<div id="res"></div>
</div>

<div class="fade" id="fade">
<h2>Sta iniziando il film...</h2>
<button class="btn main" onclick="window.close()">Esci dall'app</button>
</div>

<script>
const API="f8ecb75282e8dcea2d4845598cc7d030";
const IMG="https://image.tmdb.org/t/p/w500";
let currentType="movie";

function openBasic(){
hideAll();
document.getElementById("basic").classList.remove("hidden");
}

function openPremium(){
hideAll();
document.getElementById("premium").classList.remove("hidden");
}

function hideAll(){
["home","basic","premium","results"].forEach(id=>{
document.getElementById(id).classList.add("hidden");
});
}

async function searchBasic(){
hideAll();
document.getElementById("results").classList.remove("hidden");
const res=document.getElementById("res");
res.innerHTML="Carico...";

const genres=[...document.querySelectorAll('#basic input:checked')]
.map(x=>x.value).join(",");

if(!genres){
res.innerHTML="Seleziona almeno un genere";
return;
}

const url=`https://api.themoviedb.org/3/discover/movie?api_key=${API}&language=it-IT&sort_by=popularity.desc&with_genres=${genres}&include_adult=false`;
const r=await fetch(url);
const d=await r.json();

res.innerHTML="";
d.results.slice(0,3).forEach(m=>render(m));
}

function setType(t){currentType=t}

async function searchPremium(){
hideAll();
document.getElementById("results").classList.remove("hidden");
const res=document.getElementById("res");
res.innerHTML="Carico...";

const sliders=[...document.querySelectorAll('#premium input[type=range]')]
.filter(r=>r.value>0)
.map(r=>r.dataset.genre).join(",");

if(!sliders){
res.innerHTML="Alza almeno uno slider";
return;
}

const url=`https://api.themoviedb.org/3/discover/${currentType}?api_key=${API}&language=it-IT&sort_by=popularity.desc&with_genres=${sliders}&include_adult=true`;
const r=await fetch(url);
const d=await r.json();

res.innerHTML="";
d.results.slice(0,5).forEach(m=>render(m));
}

function render(m){
const res=document.getElementById("res");
const div=document.createElement("div");
div.className="result";
div.innerHTML=`
<div class="poster">
${m.poster_path?`<img src="${IMG+m.poster_path}">`:""}
</div>
<div>
<h3>${m.title||m.name}</h3>
<p class="small">${m.overview?m.overview.substring(0,180)+"...":""}</p>
<button class="btn secondary" onclick="end()">Guarda</button>
</div>`;
res.appendChild(div);
}

function end(){
document.getElementById("fade").classList.add("show");
}
</script>

</body>
</html>
