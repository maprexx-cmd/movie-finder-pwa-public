<!doctype html>

<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Movie Finder</title><style>
body{
  margin:0;
  font-family:system-ui,Arial;
  background:#070a12;
  color:#fff;
}
.page{display:none}
.page.active{display:block}
.container{max-width:480px;margin:auto;padding:20px}
.card{
  background:#0e1424;
  border-radius:22px;
  padding:20px;
  box-shadow:0 10px 40px rgba(0,0,0,.6);
}
h1{margin:0 0 10px}
.sub{opacity:.7;font-size:13px;line-height:1.35}
.btn{
  width:100%;
  border:none;
  border-radius:999px;
  padding:16px;
  font-weight:700;
  margin-top:12px;
  cursor:pointer;
}
.primary{background:#d9ff3a;color:#1a2cff}
.ghost{background:transparent;border:1px solid #333;color:#fff}
.row{display:flex;gap:10px}
label{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px;
  border-radius:14px;
  border:1px solid #333;
  margin-top:8px;
}
input[type=checkbox]{accent-color:#7dff52;width:18px;height:18px}
.result{
  display:flex;
  gap:12px;
  margin-top:14px;
  padding:12px;
  border-radius:16px;
  border:1px solid #333;
}
.poster{
  width:80px;height:120px;
  background:#222;
  border-radius:12px;
  overflow:hidden;
  flex:0 0 auto;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:11px;
  opacity:.85;
}
.poster img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}
.meta{
  opacity:.75;
  font-size:12px;
  margin-top:6px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.badge{
  border:1px solid #333;
  border-radius:999px;
  padding:4px 8px;
  font-size:12px;
}
.fade{
  position:fixed;
  inset:0;
  background:#000;
  display:none;
  align-items:center;
  justify-content:center;
  z-index:999;
  padding:18px;
}
.fade.show{display:flex}
.smallBtn{
  width:100%;
  border:none;
  border-radius:999px;
  padding:12px 14px;
  font-weight:700;
  cursor:pointer;
}
.smallPrimary{background:#d9ff3a;color:#1a2cff}
.smallGhost{background:transparent;border:1px solid #333;color:#fff}
hr{
  border:none;
  border-top:1px solid #222;
  margin:16px 0;
}
</style></head><body><div id="splash" class="page active">
  <div class="container">
    <div class="card" style="text-align:center;padding:60px 20px">
      <h1>Movie Finder</h1>
      <div class="sub">COSA VUOI GUARDARE OGGI?</div>
    </div>
  </div>
</div><div id="home" class="page">
  <div class="container">
    <div class="card">
      <h1>Movie Finder</h1>
      <div class="sub">COSA VUOI GUARDARE OGGI?</div>
      <button class="btn primary" onclick="goBasic()">BASIC</button>
      <button class="btn ghost" onclick="goPremium()">PREMIUM</button>
      <hr>
      <div class="sub">
        Basic: risultati reali da TMDB con locandine.
        Premium: la completiamo dopo.
      </div>
    </div>
  </div>
</div><div id="basic" class="page">
  <div class="container">
    <div class="card">
      <h1>Basic</h1>
      <div class="sub">Seleziona uno o più generi. Regola AND.</div><label><input type="checkbox" value="35"> Comico</label>
  <label><input type="checkbox" value="28"> Azione</label>
  <label><input type="checkbox" value="10749"> Romantico</label>
  <label><input type="checkbox" value="16"> Cartoni animati</label>

  <button id="basicBtn" class="btn primary" onclick="basicSearch()">Trova film</button>
  <button class="btn ghost" onclick="exitApp()">Esci</button>

  <div id="basicMsg" class="sub" style="margin-top:12px"></div>
</div>

<div id="basicResults"></div>

  </div>
</div><div id="premiumLogin" class="page">
  <div class="container">
    <div class="card">
      <h1>Premium</h1>
      <div class="sub">Accesso demo</div>
      <input id="email" placeholder="email" style="width:100%;padding:12px;border-radius:12px;margin-top:10px;border:1px solid #333;background:#0b0f1a;color:#fff">
      <input id="pass" type="password" placeholder="password" style="width:100%;padding:12px;border-radius:12px;margin-top:10px;border:1px solid #333;background:#0b0f1a;color:#fff">
      <button class="btn primary" onclick="loginPremium()">Entra</button>
      <button class="btn ghost" onclick="showHome()">Indietro</button>
      <div class="sub" style="margin-top:12px">Demo: maprexx@gmail.com e 1234</div>
    </div>
  </div>
</div><div id="premiumMenu" class="page">
  <div class="container">
    <div class="card">
      <h1>Premium</h1>
      <button class="btn primary" onclick="alert('Step dopo: Film Premium')">Film</button>
      <button class="btn primary" onclick="alert('Step dopo: Serie TV Premium')">Serie TV</button>
      <button class="btn ghost" onclick="alert('Step dopo: Trending')">Trending</button>
      <button class="btn ghost" onclick="showHome()">Home</button>
    </div>
  </div>
</div><div id="fade" class="fade">
  <div class="card" style="max-width:420px;width:100%;text-align:center">
    <h1 style="font-size:18px;margin:0 0 10px">Sta iniziando il film…</h1>
    <div class="sub">Chiudi l’app quando vuoi.</div>
    <button class="btn primary" onclick="closeFade()">Esci</button>
  </div>
</div><script>
const TMDB_KEY = "f8ecb75282e8dcea2d4845598cc7d030";
const TMDB_BASE = "https://api.themoviedb.org/3";
const TMDB_IMG = "https://image.tmdb.org/t/p/w342";

function show(id){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  window.scrollTo(0,0);
}

setTimeout(()=>show("home"),2000);

function goBasic(){ show("basic"); }
function goPremium(){ show("premiumLogin"); }
function showHome(){ show("home"); }

function exitApp(){
  document.getElementById("fade").classList.add("show");
}
function closeFade(){
  document.getElementById("fade").classList.remove("show");
}

function loginPremium(){
  const e = (document.getElementById("email").value || "").trim().toLowerCase();
  const p = (document.getElementById("pass").value || "").trim();
  if(e === "maprexx@gmail.com" && p === "1234"){
    show("premiumMenu");
    return;
  }
  alert("Credenziali non valide");
}

function pickRandom(arr, count){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    const t = a[i]; a[i] = a[j]; a[j] = t;
  }
  return a.slice(0, count);
}

function shortPlot(text){
  if(!text) return "Trama non disponibile.";
  const t = String(text).trim().replace(/\s+/g," ");
  if(t.length <= 170) return t;
  return t.slice(0, 169).trim() + "…";
}

async function basicSearch(){
  const btn = document.getElementById("basicBtn");
  const msg = document.getElementById("basicMsg");
  const box = document.getElementById("basicResults");

  const checked = Array.from(document.querySelectorAll('#basic input[type="checkbox"]:checked')).map(x=>x.value);
  if(!checked.length){
    msg.textContent = "Seleziona almeno un genere.";
    box.innerHTML = "";
    return;
  }

  msg.textContent = "Cerco su TMDB…";
  box.innerHTML = "";
  btn.disabled = true;
  btn.textContent = "Caricamento…";

  try{
    const withGenres = checked.join(","); // AND su TMDB
    const url =
      TMDB_BASE + "/discover/movie" +
      "?api_key=" + encodeURIComponent(TMDB_KEY) +
      "&language=it-IT" +
      "&sort_by=popularity.desc" +
      "&include_adult=false" +
      "&include_video=false" +
      "&with_genres=" + encodeURIComponent(withGenres);

    const r = await fetch(url);
    if(!r.ok) throw new Error("Errore rete");
    const data = await r.json();

    const results = (data && data.results) ? data.results.filter(x=>x && x.id) : [];
    if(!results.length){
      msg.textContent = "Nessun risultato. Prova a cambiare generi.";
      return;
    }

    const chosen = pickRandom(results, 3);
    msg.textContent = "Trovati 3 film per te.";

    for(const m of chosen){
      const title = m.title || "Titolo";
      const year = (m.release_date || "").slice(0,4);
      const vote = (m.vote_average !== undefined && m.vote_average !== null) ? Number(m.vote_average).toFixed(1) : "";
      const plot = shortPlot(m.overview);
      const poster = m.poster_path ? (TMDB_IMG + m.poster_path) : "";

      const div = document.createElement("div");
      div.className = "result";
      div.innerHTML =
        '<div class="poster">' +
          (poster ? '<img src="'+poster+'" alt="poster">' : 'Nessun poster') +
        '</div>' +
        '<div style="flex:1">' +
          '<div style="font-weight:800">'+ title +'</div>' +
          '<div class="meta">' +
            (year ? '<span class="badge">'+year+'</span>' : '') +
            (vote ? '<span class="badge">Voto '+vote+'</span>' : '') +
          '</div>' +
          '<div class="sub" style="margin-top:8px">'+ plot +'</div>' +
        '</div>';

      box.appendChild(div);
    }
  }catch(e){
    msg.textContent = "Errore. Controlla connessione e riprova.";
  }finally{
    btn.disabled = false;
    btn.textContent = "Trova film";
  }
}
</script></body>
</html>
