<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Movie Finder</title>

<style>
body{
margin:0;
font-family:system-ui,Arial;
background:#0b1020;
color:#e5e7eb;
padding:16px;
}
.card{
background:#111827;
border-radius:20px;
padding:18px;
margin-bottom:16px;
border:1px solid #1f2937;
}
h1,h2{margin:0 0 10px}
.small{color:#9ca3af;font-size:13px}
.row{display:flex;gap:10px;flex-wrap:wrap}
.btn{
padding:14px 20px;
border-radius:999px;
border:none;
font-weight:900;
cursor:pointer;
}
.primary{
background:linear-gradient(90deg,#d9ff2f,#39ff6b);
color:#1e40af;
}
.secondary{
background:transparent;
border:1px solid #374151;
color:#fff;
}
.hidden{display:none}
.genre{margin:10px 0}
input[type=checkbox]{width:20px;height:20px}
input[type=range]{width:100%}
.results{margin-top:10px}
.result{
border:1px solid #374151;
border-radius:16px;
padding:10px;
display:grid;
grid-template-columns:90px 1fr;
gap:12px;
margin-bottom:12px;
}
.poster{
width:90px;height:135px;
background:#000;
border-radius:12px;
overflow:hidden;
}
.poster img{width:100%;height:100%;object-fit:cover}
.fade{
position:fixed;
inset:0;
background:#000;
display:none;
align-items:center;
justify-content:center;
flex-direction:column;
z-index:99;
}
.fade.show{display:flex}
</style>
</head>

<body>

<div class="card" id="home">
<h1>Movie Finder</h1>
<p class="small">COSA VUOI GUARDARE OGGI?</p>
<div class="row">
<button class="btn primary" onclick="showBasic()">BASIC</button>
<button class="btn secondary" onclick="showPremium()">PREMIUM</button>
</div>
</div>

<div class="card hidden" id="basic">
<h2>BASIC</h2>
<p class="small">1 ricerca al giorno, 3 film</p>

<div class="genre"><label><input type="checkbox" value="35"> Comico</label></div>
<div class="genre"><label><input type="checkbox" value="28"> Azione</label></div>
<div class="genre"><label><input type="checkbox" value="10749"> Romantico</label></div>
<div class="genre"><label><input type="checkbox" value="16"> Cartoni animati</label></div>

<button class="btn primary" onclick="searchBasic()">Trova film</button>
</div>

<div class="card hidden" id="premium">
<h2>PREMIUM</h2>
<p class="small">Accesso completo</p>

<div class="row">
<button class="btn primary" onclick="setType('movie')">Film</button>
<button class="btn primary" onclick="setType('tv')">Serie TV</button>
</div>

<h3>Preferenze</h3>

<div class="genre">Comico <input type="range" min="0" max="5" data-g="35"></div>
<div class="genre">Azione <input type="range" min="0" max="5" data-g="28"></div>
<div class="genre">Romantico <input type="range" min="0" max="5" data-g="10749"></div>
<div class="genre">Animazione <input type="range" min="0" max="5" data-g="16"></div>

<div class="row">
<button class="btn primary" onclick="searchPremium()">Cerca</button>
<button class="btn secondary" onclick="openTrending()">Trending</button>
</div>
</div>

<div class="card hidden" id="trending">
<h2>Trending settimanale</h2>
<div class="row">
<button class="btn primary" onclick="loadTrending('movie')">Trending Film</button>
<button class="btn primary" onclick="loadTrending('tv')">Trending Serie TV</button>
<button class="btn secondary" onclick="goHome()">Home</button>
</div>
<div class="results" id="trendBox"></div>
</div>

<div class="card hidden" id="results">
<h2>Risultati</h2>
<div class="results" id="resultsBox"></div>
<button class="btn secondary" onclick="goHome()">Home</button>
</div>

<div class="fade" id="fade">
<h2>Sta iniziando il film...</h2>
<button class="btn primary" onclick="window.close()">Esci</button>
</div>

<script>
const API_KEY="f8ecb75282e8dcea2d4845598cc7d030";
const IMG="https://image.tmdb.org/t/p/w500";
let currentType="movie";

function hideAll(){
["home","basic","premium","results","trending"].forEach(id=>{
document.getElementById(id).classList.add("hidden");
});
}

function goHome(){hideAll();document.getElementById("home").classList.remove("hidden")}
function showBasic(){hideAll();document.getElementById("basic").classList.remove("hidden")}
function showPremium(){hideAll();document.getElementById("premium").classList.remove("hidden")}
function openTrending(){hideAll();document.getElementById("trending").classList.remove("hidden")}

function setType(t){currentType=t}

async function searchBasic(){
hideAll();
document.getElementById("results").classList.remove("hidden");
const box=document.getElementById("resultsBox");
box.innerHTML="Carico...";

const genres=[...document.querySelectorAll('#basic input:checked')].map(x=>x.value).join(",");
if(!genres){box.innerHTML="Seleziona un genere";return;}

const r=await fetch(`https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&language=it-IT&with_genres=${genres}&include_adult=false`);
const d=await r.json();

box.innerHTML="";
(d.results||[]).slice(0,3).forEach(m=>render(m));
}

async function searchPremium(){
hideAll();
document.getElementById("results").classList.remove("hidden");
const box=document.getElementById("resultsBox");
box.innerHTML="Carico...";

const sliders=[...document.querySelectorAll('#premium input[type=range]')]
.filter(r=>r.value>0).map(r=>r.dataset.g).join(",");

if(!sliders){box.innerHTML="Alza almeno uno slider";return;}

const r=await fetch(`https://api.themoviedb.org/3/discover/${currentType}?api_key=${API_KEY}&language=it-IT&with_genres=${sliders}&include_adult=true`);
const d=await r.json();

box.innerHTML="";
(d.results||[]).slice(0,5).forEach(m=>render(m));
}

async function loadTrending(type){
const box=document.getElementById("trendBox");
box.innerHTML="Carico...";
const r=await fetch(`https://api.themoviedb.org/3/trending/${type}/week?api_key=${API_KEY}`);
const d=await r.json();
box.innerHTML="";
(d.results||[]).slice(0,5).forEach(m=>render(m));
}

function render(m){
const box=document.getElementById("resultsBox")||document.getElementById("trendBox");
const div=document.createElement("div");
div.className="result";
div.innerHTML=`
<div class="poster">${m.poster_path?`<img src="${IMG+m.poster_path}">`:""}</div>
<div>
<h3>${m.title||m.name}</h3>
<p class="small">${m.overview?m.overview.substring(0,140)+"...":""}</p>
<button class="btn secondary" onclick="document.getElementById('fade').classList.add('show')">Guarda</button>
</div>`;
box.appendChild(div);
}
</script>

</body>
</html>
