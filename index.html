<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Movie Finder</title>

<style>
:root{
--bg:#0b1020;
--card:#111827;
--text:#e5e7eb;
--muted:#9ca3af;
--line:rgba(255,255,255,.1);
--acidY:#d9ff2f;
--acidG:#39ff6b;
--blue:#1e40af;
}
*{box-sizing:border-box}
body{
margin:0;
font-family:system-ui;
background:linear-gradient(180deg,#050813,#0b1020);
color:var(--text);
padding:16px;
}
.card{
background:rgba(255,255,255,.03);
border:1px solid var(--line);
border-radius:20px;
padding:16px;
margin-bottom:16px;
}
h1,h2,h3{margin:0 0 10px}
.small{font-size:12px;color:var(--muted)}
.btn{
padding:12px 18px;
border-radius:999px;
border:none;
font-weight:900;
cursor:pointer;
}
.main{
background:linear-gradient(90deg,var(--acidY),var(--acidG));
color:var(--blue);
}
.secondary{
background:transparent;
border:1px solid var(--line);
color:var(--text);
}
.hidden{display:none}
input{
width:100%;
padding:12px;
border-radius:14px;
border:1px solid var(--line);
background:#000;
color:#fff;
}
input[type=range]{width:100%}
.genre{
border:1px solid var(--line);
border-radius:14px;
padding:10px;
margin-bottom:8px;
}
.badge{
float:right;
background:rgba(217,255,47,.15);
border:1px solid rgba(217,255,47,.3);
color:var(--acidY);
padding:4px 10px;
border-radius:999px;
font-size:12px;
}
.providers{
display:flex;
gap:8px;
flex-wrap:wrap;
}
.provider{
border:1px solid var(--line);
border-radius:999px;
padding:6px 10px;
display:flex;
align-items:center;
gap:6px;
font-size:12px;
cursor:pointer;
}
.provider img{width:22px;height:22px;border-radius:6px}
.provider.active{
border-color:var(--acidG);
background:rgba(57,255,107,.15);
}
.tabs{display:flex;gap:8px;margin-bottom:10px;flex-wrap:wrap}
.tab{
padding:8px 12px;
border-radius:999px;
border:1px solid var(--line);
cursor:pointer;
}
.tab.active{
background:linear-gradient(90deg,var(--acidY),var(--acidG));
color:var(--blue);
border:none;
}
.result{
border:1px solid var(--line);
border-radius:16px;
padding:10px;
display:grid;
grid-template-columns:90px 1fr;
gap:10px;
margin-bottom:12px;
}
.poster{
width:90px;height:135px;
background:#000;
border-radius:12px;
overflow:hidden;
}
.poster img{width:100%;height:100%;object-fit:cover}
.fade{
position:fixed;
inset:0;
background:#000;
display:none;
align-items:center;
justify-content:center;
flex-direction:column;
z-index:10;
}
.fade.show{display:flex}
</style>
</head>

<body>

<div class="card">
<h1>Movie Finder</h1>
<p class="small">Cosa vuoi guardare oggi?</p>
<button class="btn main" onclick="start()">Cosa guardi oggi?</button>
</div>

<div class="card" id="login">
<h2>Premium</h2>
<p class="small">Demo Premium</p>
<input id="email" placeholder="Email">
<br><br>
<input id="password" type="password" placeholder="Password">
<br><br>
<button class="btn main" onclick="login()">Accedi Premium</button>
<p class="small" id="loginMsg"></p>
</div>

<div class="card hidden" id="filters">
<h2>Preferenze</h2>

<div class="genre">Comico <span class="badge" id="b35">0</span>
<input type="range" min="0" max="5" oninput="upd(35,this.value)">
</div>

<div class="genre">Azione <span class="badge" id="b28">0</span>
<input type="range" min="0" max="5" oninput="upd(28,this.value)">
</div>

<div class="genre">Romantico <span class="badge" id="b10749">0</span>
<input type="range" min="0" max="5" oninput="upd(10749,this.value)">
</div>

<div class="genre">Animazione <span class="badge" id="b16">0</span>
<input type="range" min="0" max="5" oninput="upd(16,this.value)">
</div>

<button class="btn main" onclick="loadProviders()">Avanti</button>
</div>

<div class="card hidden" id="platforms">
<h2>Piattaforme</h2>
<div class="providers" id="provList"></div>
<br>
<button class="btn main" onclick="search()">Cerca</button>
</div>

<div class="card hidden" id="results">
<h2>Risultati</h2>
<div id="res"></div>
</div>

<div class="fade" id="fade">
<h2>Sta iniziando il film...</h2>
<button class="btn main" onclick="window.close()">Esci dall'app</button>
</div>

<script>
const API="f8ecb75282e8dcea2d4845598cc7d030";
const IMG="https://image.tmdb.org/t/p/w500";
const LOGO="https://image.tmdb.org/t/p/w45";
let genres={}, providers=[];

function start(){}

function login(){
if(email.value==="maprexx@gmail.com" && password.value==="1234"){
login.classList.add("hidden");
filters.classList.remove("hidden");
}else{
loginMsg.textContent="Credenziali non valide";
}
}

function upd(id,val){
genres[id]=val;
document.getElementById("b"+id).textContent=val;
}

async function loadProviders(){
filters.classList.add("hidden");
platforms.classList.remove("hidden");
provList.innerHTML="Carico...";
const r=await fetch(`https://api.themoviedb.org/3/watch/providers/movie?api_key=${API}&watch_region=IT`);
const d=await r.json();
provList.innerHTML="";
d.results.forEach(p=>{
const el=document.createElement("div");
el.className="provider";
el.innerHTML=`<img src="${LOGO+p.logo_path}">${p.provider_name}`;
el.onclick=()=>{
el.classList.toggle("active");
if(providers.includes(p.provider_id)){
providers=providers.filter(x=>x!==p.provider_id);
}else{
providers.push(p.provider_id);
}
};
provList.appendChild(el);
});
}

async function search(){
platforms.classList.add("hidden");
results.classList.remove("hidden");
res.innerHTML="Carico...";
const g=Object.keys(genres).filter(x=>genres[x]>0).join(",");
const p=providers.join("|");
const r=await fetch(`https://api.themoviedb.org/3/discover/movie?api_key=${API}&language=it-IT&watch_region=IT&with_genres=${g}&with_watch_providers=${p}&with_watch_monetization_types=flatrate|rent|buy`);
const d=await r.json();
res.innerHTML="";
d.results.slice(0,5).forEach(m=>{
const div=document.createElement("div");
div.className="result";
div.innerHTML=`
<div class="poster">${m.poster_path?`<img src="${IMG+m.poster_path}">`:""}</div>
<div>
<h3>${m.title}</h3>
<p class="small">${m.overview||""}</p>
<button class="btn secondary" onclick="fade.classList.add('show')">Guarda</button>
</div>`;
res.appendChild(div);
});
}
</script>

</body>
</html>
