<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Movie Finder</title>

<style>
:root{
  --bg1:#0f172a;
  --bg2:#020617;
  --card:#0b1220;
  --text:#ffffff;
  --muted:rgba(255,255,255,0.72);
  --acidY:#EFFF00;
  --acidG:#7CFF00;
  --blue:#0033cc;
}

body{
  margin:0;
  font-family:Arial,sans-serif;
  background:radial-gradient(circle at top,var(--bg1),var(--bg2));
  color:var(--text);
}

.container{
  max-width:420px;
  margin:40px auto;
  padding:20px;
}

.card{
  background:var(--card);
  border-radius:18px;
  padding:20px;
  box-shadow:0 0 40px rgba(0,0,0,0.6);
}

h1{
  font-size:24px;
  margin:0 0 16px 0;
}

h2{
  font-size:20px;
  margin:0 0 10px 0;
}

p{
  color:var(--muted);
  margin:8px 0 0 0;
  line-height:1.35;
}

button{
  width:100%;
  margin-top:14px;
  padding:16px;
  border-radius:30px;
  border:none;
  background:linear-gradient(90deg,var(--acidY),var(--acidG));
  color:var(--blue);
  font-size:18px;
  font-weight:bold;
  cursor:pointer;
}

.secondary{
  background:transparent;
  border:1px solid rgba(255,255,255,0.25);
  color:#fff;
}

.small{
  font-size:14px;
  padding:12px;
  border-radius:18px;
}

label{
  display:flex;
  align-items:center;
  margin:10px 0;
  font-size:16px;
}

input[type="checkbox"]{
  margin-right:10px;
  width:20px;
  height:20px;
  accent-color:var(--acidG);
}

input[type="password"]{
  width:100%;
  box-sizing:border-box;
  margin-top:12px;
  padding:14px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,0.18);
  background:rgba(255,255,255,0.06);
  color:#fff;
  font-size:16px;
  outline:none;
}

.row{
  display:flex;
  gap:10px;
}

.row button{
  width:50%;
}

.hidden{
  display:none;
}

.result{
  margin-top:20px;
  background:var(--card);
  border-radius:18px;
  padding:20px;
  display:none;
}

.posterBox{
  width:100%;
  height:260px;
  border-radius:14px;
  margin-bottom:12px;
  background:#111827;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}

.posterBox img{
  width:100%;
  height:100%;
  object-fit:cover;
}

.posterFallback{
  font-size:13px;
  color:var(--muted);
}

.close-btn{
  margin-top:16px;
  background:transparent;
  border:1px solid #444;
  color:#fff;
  padding:12px;
  border-radius:20px;
  cursor:pointer;
  width:auto;
}

.overlay{
  position:fixed;
  inset:0;
  background:black;
  display:none;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  text-align:center;
  z-index:999;
  padding:20px;
}

.overlay.active{
  display:flex;
}

.overlay h2{
  font-size:26px;
  margin-bottom:10px;
}

.overlay p{
  color:var(--acidY);
  font-size:18px;
  font-weight:bold;
  margin-bottom:20px;
}

.badge{
  display:inline-block;
  margin-top:10px;
  padding:8px 10px;
  border-radius:999px;
  background:rgba(255,255,255,0.08);
  color:var(--muted);
  font-size:13px;
}
</style>
</head>

<body>

<div class="container">

  <div class="card" id="screenStart">
    <h1>Movie Finder</h1>
    <p>Scegli come vuoi usare l’app.</p>

    <button onclick="startBasic()">Continua senza account</button>

    <button class="secondary" onclick="openPremium()">Accedi Premium</button>

    <span class="badge" id="modeBadge">Modalità: non selezionata</span>
  </div>

  <div class="card hidden" id="screenPremium">
    <h1>Accesso Premium</h1>
    <p>Inserisci il codice Premium.</p>

    <input type="password" id="premiumCode" placeholder="Codice Premium">

    <button onclick="loginPremium()">Entra</button>
    <button class="secondary small" onclick="backToStart()">Indietro</button>

    <p id="loginMsg"></p>
  </div>

  <div class="card hidden" id="screenQuestion">
    <h1>Cosa guardi oggi?</h1>

    <div id="toggleMedia" class="hidden">
      <div class="row">
        <button class="secondary small" onclick="setMedia('movie')">Film</button>
        <button class="secondary small" onclick="setMedia('tv')">Serie TV</button>
      </div>
      <span class="badge" id="mediaBadge">Contenuto: Film</span>
    </div>

    <label><input type="checkbox" value="35">Comico</label>
    <label><input type="checkbox" value="28">Azione</label>
    <label><input type="checkbox" value="10749">Romantico</label>

    <button onclick="cercaTitolo()">Cosa guardi oggi?</button>
    <button class="secondary small" onclick="resetApp()">Cambia modalità</button>
  </div>

  <div class="result" id="result">
    <div class="posterBox" id="posterBox">
      <div class="posterFallback">Locandina non disponibile</div>
    </div>
    <h2 id="movieTitle"></h2>
    <p id="movieOverview"></p>
    <button class="close-btn" onclick="chiudiRisultato()">Chiudi</button>
  </div>

</div>

<div class="overlay" id="overlay">
  <h2>Sta per iniziare</h2>
  <p id="overlayTitle"></p>
  <button onclick="chiudiOverlay()">Ok</button>
</div>

<script>
const API_KEY = "f8ecb75282e8dcea2d4845598cc7d030";
const IMG = "https://image.tmdb.org/t/p/w500";

const PREMIUM_CODE = "1234";

let mode = "none";
let media = "movie";
let lastTitle = "";

function show(id){
  document.getElementById("screenStart").classList.add("hidden");
  document.getElementById("screenPremium").classList.add("hidden");
  document.getElementById("screenQuestion").classList.add("hidden");
  document.getElementById(id).classList.remove("hidden");
}

function setBadge(){
  const b = document.getElementById("modeBadge");
  if(mode==="basic") b.innerText = "Modalità: BASIC";
  else if(mode==="premium") b.innerText = "Modalità: PREMIUM";
  else b.innerText = "Modalità: non selezionata";
}

function setMediaBadge(){
  const m = document.getElementById("mediaBadge");
  m.innerText = "Contenuto: " + (media==="movie" ? "Film" : "Serie TV");
}

function startBasic(){
  mode = "basic";
  media = "movie";
  setBadge();
  document.getElementById("toggleMedia").classList.add("hidden");
  show("screenQuestion");
}

function openPremium(){
  document.getElementById("premiumCode").value = "";
  document.getElementById("loginMsg").innerText = "";
  show("screenPremium");
}

function loginPremium(){
  const code = document.getElementById("premiumCode").value.trim();
  if(code !== PREMIUM_CODE){
    document.getElementById("loginMsg").innerText = "Codice errato.";
    return;
  }
  mode = "premium";
  media = "movie";
  setBadge();
  document.getElementById("toggleMedia").classList.remove("hidden");
  setMediaBadge();
  show("screenQuestion");
}

function backToStart(){
  show("screenStart");
}

function setMedia(val){
  media = val;
  setMediaBadge();
}

function resetApp(){
  mode = "none";
  media = "movie";
  setBadge();
  document.getElementById("result").style.display = "none";
  show("screenStart");
}

function buildDiscoverUrl(genres){
  if(media==="movie"){
    return `https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&with_genres=${genres}&language=it-IT&include_adult=false`;
  }
  return `https://api.themoviedb.org/3/discover/tv?api_key=${API_KEY}&with_genres=${genres}&language=it-IT&include_adult=false`;
}

function getTitle(item){
  return media==="movie" ? item.title : item.name;
}

function getOverview(item){
  return item.overview;
}

function cercaTitolo(){
  const checked = document.querySelectorAll('#screenQuestion input[type="checkbox"]:checked');
  if(checked.length===0) return;

  const genres = [...checked].map(c=>c.value).join(",");

  fetch(buildDiscoverUrl(genres))
    .then(r=>r.json())
    .then(d=>{
      if(!d.results || d.results.length===0) return;

      const item = d.results.find(f=>f.poster_path) || d.results[0];
      lastTitle = getTitle(item);

      document.getElementById("movieTitle").innerText = lastTitle;
      document.getElementById("movieOverview").innerText = getOverview(item) || "Descrizione non disponibile";

      const posterBox = document.getElementById("posterBox");
      posterBox.innerHTML = "";

      if(item.poster_path){
        const img = document.createElement("img");
        img.src = IMG + item.poster_path;
        posterBox.appendChild(img);
      }else{
        posterBox.innerHTML = "<div class='posterFallback'>Locandina non disponibile</div>";
      }

      document.getElementById("result").style.display = "block";
      document.getElementById("result").scrollIntoView({behavior:"smooth", block:"start"});
    });
}

function chiudiRisultato(){
  document.getElementById("result").style.display = "none";
  document.getElementById("overlayTitle").innerText = lastTitle;
  document.getElementById("overlay").classList.add("active");
}

function chiudiOverlay(){
  document.getElementById("overlay").classList.remove("active");
}
</script>

</body>
</html>
